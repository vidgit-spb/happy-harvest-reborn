# Happy Harvest Reborn - –ú–æ–¥—É–ª—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ú–æ–¥—É–ª—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∏–≥—Ä—ã Happy Harvest Reborn, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —Å—É—â–Ω–æ—Å—Ç–∏ TypeORM, –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å PostgreSQL.

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
db/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ entities/           # –°—É—â–Ω–æ—Å—Ç–∏ TypeORM
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Animal.ts       # –ú–æ–¥–µ–ª—å –∂–∏–≤–æ—Ç–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Building.ts     # –ú–æ–¥–µ–ª—å –∑–¥–∞–Ω–∏–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Garden.ts       # –ú–æ–¥–µ–ª—å —Å–∞–¥–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GardenMember.ts # –°–≤—è–∑—å –º–µ–∂–¥—É —Å–∞–¥–∞–º–∏ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ InviteBonus.ts  # –ë–æ–Ω—É—Å—ã –∑–∞ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Plot.ts         # –ú–æ–¥–µ–ª—å –≥—Ä—è–¥–æ–∫
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Purchase.ts     # –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ QuestProgress.ts # –ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–¥–∞–Ω–∏–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ StarTransaction.ts # –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∑–≤—ë–∑–¥
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Tree.ts         # –ú–æ–¥–µ–ª—å –¥–µ—Ä–µ–≤—å–µ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ User.ts         # –ú–æ–¥–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ migrations/         # –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ data-source.ts      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ index.ts            # –û—Å–Ω–æ–≤–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ package.json
‚îî‚îÄ‚îÄ tsconfig.json
```

## üèó –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

### User
–•—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ, –≤–∫–ª—é—á–∞—è:
- Telegram ID –∏ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ò–≥—Ä–æ–≤–∞—è –≤–∞–ª—é—Ç–∞ (–º–æ–Ω–µ—Ç—ã –∏ –∑–≤–µ–∑–¥—ã)
- –£—Ä–æ–≤–µ–Ω—å –∏ –æ–ø—ã—Ç
- –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –∏ –¥—Ä—É–≥–∏–µ –∏–≥—Ä–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

### Garden
–ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å–∞–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
- –í–ª–∞–¥–µ–ª–µ—Ü —Å–∞–¥–∞
- –ù–∞–∑–≤–∞–Ω–∏–µ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ
- –†–∞–∑–º–µ—Ä —Å–∞–¥–∞
- –û—Å–æ–±—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–Ω–∞–ª–∏—á–∏–µ —Å–æ–±–∞–∫–∏, –±–æ–Ω—É—Å—ã –∏ –¥—Ä.)

### Plot
–ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –≥—Ä—è–¥–∫—É –≤ —Å–∞–¥—É:
- –ü–æ—Å–∞–∂–µ–Ω–Ω–æ–µ —Ä–∞—Å—Ç–µ–Ω–∏–µ
- –°—Ç–∞–¥–∏—è —Ä–æ—Å—Ç–∞
- –í—Ä–µ–º—è –ø–æ—Å–∞–¥–∫–∏ –∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–æ–ª–∏–≤–∞
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ —Å–∞–¥—É

### Animal, Tree, Building
–ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –¥—Ä—É–≥–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å–∞–¥–∞ —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.

## üß™ –ú–∏–≥—Ä–∞—Ü–∏–∏

–ú–æ–¥—É–ª—å —Å–æ–¥–µ—Ä–∂–∏—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –Ω–∞—á–∞–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —Å—Ö–µ–º—ã.

### –ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–π

```bash
# –ò–∑ –∫–æ—Ä–Ω—è –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
pnpm --filter db typeorm migration:run
```

### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
# –ò–∑ –∫–æ—Ä–Ω—è –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
pnpm --filter db typeorm migration:generate src/migrations/–Ω–∞–∑–≤–∞–Ω–∏–µ-–º–∏–≥—Ä–∞—Ü–∏–∏
```

## üîÑ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –ø—Ä–æ–µ–∫—Ç–µ

–ú–æ–¥—É–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –≤ –¥—Ä—É–≥–∏—Ö —á–∞—Å—Ç—è—Ö –ø—Ä–æ–µ–∫—Ç–∞ —á–µ—Ä–µ–∑ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:

```json
{
  "dependencies": {
    "db": "workspace:*"
  }
}
```

### –ü—Ä–∏–º–µ—Ä –∏–º–ø–æ—Ä—Ç–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```typescript
import { User, Garden, Plot } from 'db';
import { DataSource } from 'typeorm';
import { AppDataSource } from 'db';

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö
AppDataSource.initialize()
  .then(() => {
    // –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
  })
  .catch((error) => console.log(error));

// –ò–ª–∏ –∏–º–ø–æ—Ä—Ç —Ç–æ–ª—å–∫–æ —Å—É—â–Ω–æ—Å—Ç–µ–π
@Module({
  imports: [
    TypeOrmModule.forFeature([User, Garden, Plot]),
  ],
  // ...
})
export class SomeModule {}
```

## üõ† –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –ò–Ω–¥–µ–∫—Å—ã

–î–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –º—ã —Å–æ–∑–¥–∞–ª–∏ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è:
- –°–≤—è–∑–µ–π –º–µ–∂–¥—É —Å—É—â–Ω–æ—Å—Ç—è–º–∏ (userId, gardenId –∏ —Ç.–¥.)
- –ü–æ–ª–µ–π, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (stage, type –∏ —Ç.–¥.)
- –í—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫ (createdAt, updatedAt)

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

–ú–æ–¥—É–ª—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –≤—Ç–æ—Ä–æ–≥–æ —É—Ä–æ–≤–Ω—è TypeORM, —á—Ç–æ —É—Å–∫–æ—Ä—è–µ—Ç —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ.

### –û—Ç–Ω–æ—à–µ–Ω–∏—è –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí –°–∞–¥—ã (–æ–¥–∏–Ω-–∫–æ-–º–Ω–æ–≥–∏–º)
- –°–∞–¥ ‚Üí –£—á–∞—Å—Ç–Ω–∏–∫–∏ —Å–∞–¥–∞ (–æ–¥–∏–Ω-–∫–æ-–º–Ω–æ–≥–∏–º)
- –°–∞–¥ ‚Üí –ì—Ä—è–¥–∫–∏, –ñ–∏–≤–æ—Ç–Ω—ã–µ, –î–µ—Ä–µ–≤—å—è, –ó–¥–∞–Ω–∏—è (–æ–¥–∏–Ω-–∫–æ-–º–Ω–æ–≥–∏–º)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –ü–æ–∫—É–ø–∫–∏ (–æ–¥–∏–Ω-–∫–æ-–º–Ω–æ–≥–∏–º)
